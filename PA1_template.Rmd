---
author: "Michael Park"
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
First, we need to get the data from the course website. The code below will download the zip file to the working directory, unzip it, and load the unzipped data. 

```{r}
download.file("http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", "activity.zip")
unzip("activity.zip")
activity <- read.csv("activity.csv", header = TRUE, stringsAsFactors = FALSE)
```

For some of the calculations, the ddply function will be necessary. Also in the final steps, we will need the date variables to be in date format, rather than character.

```{r}
library(plyr)
activity[,2]<-as.Date(activity[,2])
```

## What is mean total number of steps taken per day?
Later we will attempt to adjust for the missing values, but for the moment we will compute the daily sums based on the measurements we do have.

```{r}

dailysum <- ddply(activity, "date", summarise, 
                  perday = sum(steps, na.rm = TRUE))
hist(dailysum[,2], xlab = "Steps per day", main = "")
dailymean <- mean(dailysum[,2])
dailymed <- median(dailysum[,2])
dailymean
dailymed
```

## What is the average daily activity pattern?
```{r}
intmean <- ddply(activity, "interval", summarise,
                perint = mean(steps, na.rm = TRUE))  # computes the average number of teps for each 5 minute interval
intmax <- intmean[which.max(intmean[,2]),1]  #return the 5 minute interval which has the maximum average number of steps
```
## Imputing missing values
Now to return to the issue of missing values. The simplest method for compensating would be to substitute in the daily average value for any missing value. There are two issues with this strategy. First, the number of steps taken can vary greatly between times of day. Secondly, for any day with no recorded measurements at all, we would be left with the assumption that nobody walked at all on that day. The best balance between accuracy and simplicity of calculation seems to be to use the appropriate five minute interval average as a substitute for any missing values. 

```{r}
missing <- sum(is.na(activity[,1]))
missing
nalist <- unlist (lapply (activity, function (x) which (is.na (x))))
intlist <- rep(intmean$perint, 61)
adjusted <- activity
for (i in 1:length(nalist)){
  adjusted[nalist[i],1] <- intlist[i]
}
adjsum <- ddply(adjusted, "date", summarise, 
                  perday = sum(steps))
hist(adjsum[,2], xlab = "Steps per day", main = "")
adjmean <- mean(adjsum[,2])
adjmed <- median(adjsum[,2])
adjmean
adjmed
```
Approximately 13% of the observations were missing. By replacing them with average values instead of treating them as zeros, this moved many of the daily totals, as well as the adjusted mean and median, much closer to the previous median value. 

## Are there differences in activity patterns between weekdays and weekends?
```{r}

#adjusted[,4]<- NA #creates 4th column to fill with new variable
day <- weekdays(adjusted[,2])
for (i in 1:length(day)){
  if (day[i] == "Saturday" |day[i] == "Sunday"){
    day[i] <- "Weekend"
  } else day[i] <- "Weekday"
}
adjusted[,4]<- as.factor(day)

```